# Fallnotiz: Statistikprojekt HS25

| Regel | Schwelle / Grund | Datum | Ergebnis | Entscheidung | Anmerkung | Notebook |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **Datenfilterung** | `PRODUKT_ID == "Zug"` | 02.10.2025 | Reduktion auf ca. 4.6 Mio. Zeilen | Ausschluss von Bus/Tram | Fokus auf Schienenverkehr zur Reduktion von Störfaktoren. | [N01_EDA.ipynb](notebooks/N01_EDA.ipynb) |
| **Missing Value Check** | Prüfung `delay_arrival_s` | 02.10.2025 | ~8.95% fehlende Werte | Dokumentation der Lücken | Wichtig für die spätere Bewertung der Stichproben-Qualität. | [N01_EDA.ipynb](notebooks/N01_EDA.ipynb) |
| **Einheiten-Skalierung** | Umrechnung `s` zu `min` | 02.10.2025 | Neue Spalten (z.B. `delay_arrival_min`) | Standardisierung der Metriken | Minuten sind im Bahnverkehr die übliche intuitive Maßeinheit. | [N02.ipynb](notebooks/N02.ipynb) |
| **Feature Engineering** | Wochentags-Extraktion | 02.10.2025 | Spalte `Wochentag` erstellt | Ermöglicht Vergleich Werktag vs. Wochenende | Nutzung von `strptime` für korrekte zeitliche Einordnung. | [N02.ipynb](notebooks/N02.ipynb) |
| **Lageparameter** | Vergleich Mean vs. Median | 02.10.2025 | Mean > Median | Median als primäres Lagemaß gewählt | Verteilung ist rechtsschief; Median ist robuster gegenüber Verspätungs-Peaks. | [N02.ipynb](notebooks/N02.ipynb) |
| **Ausreißer-Regel** | Tukey-Methode (1.5x / 3.0x IQR) | 02.10.2025 | Extremwerte (> 5,12 min): 1.9% | Beibehaltung für Analyse, Filterung für Plots | "Heavy Tails" sind charakteristisch für Bahndaten (Großereignisse). | [N02.ipynb](notebooks/N02.ipynb) |
| **Korrelations-Check** | Pearson vs. Spearman | 09.10.2025 | Pearson: 0.82, Spearman: 0.68 | Pearson als Leitmetrik für lineare Kausalität | Spearman < Pearson deutet auf "Aufhol-Effekte" oder Ausreißer hin. | [N03.ipynb](notebooks/N03.ipynb) |
| **Multivariate Prüfung** | Korrelation zu "Pünktlich" | 09.10.2025 | Negative Korrelation zw. Verspätung und Status | Validierung der Zielvariable | Bestätigt, dass die binäre Variable den Zeitverlust korrekt widerspiegelt. | [N03.ipynb](notebooks/N03.ipynb) |
| **Gesetz der Großen Zahlen (LLN)** | Konvergenz-Simulation | 16.10.2025 | Mittelwert stabilisiert sich ab ca. 50k Zeilen | Datensatzgröße ist hochgradig repräsentativ | Visualisierung des kumulativen Mittelwerts ("Zufall stabilisiert sich"). | [N04.ipynb](notebooks/N04.ipynb) |
| **Risiko-Analyse** | Definition "Verspätet" > 3 Min. | 16.10.2025 | Basis für RR- und OR-Berechnung | Festlegung einer praxisrelevanten Schwelle | Orientierung an den SBB-Standards für signifikante Verspätungen. | [N04.ipynb](notebooks/N04.ipynb) |
| **Risiko-Metriken (RR / OR)** | Vergleich Rush Hour vs. Off-Peak | 16.10.2025 | Quantifizierung des Peak-Risikos | Identifikation kritischer Zeitfenster | Anwendung von Relative Risk (RR) und Odds Ratio (OR) nach VL5. | [N04.ipynb](notebooks/N04.ipynb) |
| **Verteilungsprüfung** | Normal- vs. Exponentialvert. | 16.10.2025 | Nicht-Symmetrie (Rechtsschiefe) | Ablehnung der Normalverteilung für Rohdaten | Exponentialverteilung eignet sich besser für Wartezeit-Modellierung. | [N04.ipynb](notebooks/N04.ipynb) |
| **Inferenzstatistik (CI)** | 95%-Konfidenzintervall ($\alpha = 0.05$) | 23.10.2025 | Simulation liefert ~95% Coverage | Validierung der Schätzer ($\mu$, $\pi$) | t-Intervall fängt den Populationswert zuverlässig ein. | [N05.ipynb](notebooks/N05.ipynb) |
| **Schätzgenauigkeit** | Zentraler Grenzwertsatz (ZGS) | 23.10.2025 | SE sinkt mit steigendem $n$ | Stichproben-Größe $n=1000$ ausreichend genau | Trotz Rechtsschiefe der Rohdaten nähert sich die Verteilung der Mittelwerte der Normalverteilung an. | [N05.ipynb](notebooks/N05.ipynb) |
| **Bootstrapping** | 2000 Iterationen (Resampling) | 28.10.2025 | Robustere Schätzung des Medians | Nutzung für nicht-parametrische Parameter | Bootstrap-CI für Median [0.53, 0.85] deckt Populations-Median (0.62) ab. | [N05.ipynb](notebooks/N05.ipynb) |
| **Data Enrichment (Geo)** | BFS-Gemeindetypologie 2020 | 03.01.2026 | Mapping-Quote > 95% | Erfolgreiche Klassifizierung der Haltestellen | Integration externer Geodaten (GPKG) via Fuzzy-Matching der Gemeindenamen zur Zuweisung der Regionstypen. | [N06.ipynb](notebooks/N06.ipynb) |
| **Hypothesentest (Lage)** | Kruskal-Wallis-H-Test | 03.01.2026 | $H = 4022.2$, $p \approx 0.00$ | Ablehnung der Nullhypothese ($H_0$) | Statistisch hochsignifikant aufgrund der enormen Stichprobengröße ($N \approx 4,56$ Mio.); Test auf Unterschiede in der zentralen Tendenz. | [N06.ipynb](notebooks/N06.ipynb) |
| **Relevanz-Prüfung** | Effektstärke $\epsilon^2$ (Epsilon-Squared) | 03.01.2026 | $\epsilon^2 = 0.000883$ | **Praktisch vernachlässigbar** | Wichtige Einordnung: Trotz Signifikanz erklärt der Regionstyp < 0,1% der Varianz. Der reale Median-Unterschied beträgt lediglich 6 Sekunden. | [N06.ipynb](notebooks/N06.ipynb) |
| **Regressions-Analyse** | OLS (Lineare Regression) | 03.01.2026 | $\beta_1 = -0.0713$, $R^2 = 0.012$ | Paradoxon: Mehr Verkehr führt nicht zu mehr Verspätung | **Überraschende Erkenntnis:** Bahnhöfe mit hohem Verkehrsaufkommen (Knoten) weisen eine höhere Resilienz und geringere Durchschnittsverspätungen auf. | [N06.ipynb](notebooks/N06.ipynb) |
| **Geospatiale Analyse** | Interaktive Folium-Karte | 03.01.2026 | Identifikation von Hotspot-Korridoren | Räumliche Cluster statt flächiger Regionen | Visualisierung zeigt, dass Verspätungen primär entlang von Hauptachsen wandern, unabhängig vom Regionstyp der Gemeinde. | [N06.ipynb](notebooks/N06.ipynb) |
| **Hypothesentest (Tageszeit)** | Kruskal-Wallis-Test ($\alpha = 0.05$) | 29.10.2025 | $p < 0.05$; $\epsilon^2 = 0.0135$ | Ablehnung $H_0$ | Signifikante Unterschiede zwischen Nacht, Peaks und Tag; Epsilon² zeigt kleinen Effekt. | [N07.ipynb](notebooks/N07.ipynb) |
| **Post-Hoc Analyse (Zeit)** | Mann-Whitney-U mit FDR-Korrektur | 30.10.2025 | Fast alle Paare signifikant ($p_{adj} < 0.05$) | Beibehaltung der Zeit-Klassierung | Benjamini-Hochberg Verfahren zur Vermeidung der Alpha-Fehler-Kumulierung. | [N07.ipynb](notebooks/N07.ipynb) |
| **A/B-Test (Wochenende)** | Chi-Quadrat-Test (Pünktlichkeitsrate) | 06.11.2025 | $p \approx 0$; $\chi^2 = 3645.1$ | Wochenende ist pünktlicher | Pünktlichkeit am Wochenende um 1.6 Prozentpunkte höher (weniger Pendlerverkehr). | [N08.ipynb](notebooks/N08.ipynb) |
| **Mehrfachtests (Betreiber)** | Kruskal-Wallis & Post-Hoc (FDR) | 06.11.2025 | SBB vs. Regionalbahnen signifikant | Differenzierung Fern- vs. Regionalverkehr | Bestätigt, dass S-Bahn-Systeme (z.B. RBS/Thurbo) strukturell anders performen als die SBB. | [N08.ipynb](notebooks/N08.ipynb) |
| **Effektgrößen (ZH vs. SG)** | Cohen's d & Rank-Biserial | 13.11.2025 | d = 0.077; $r_{bc} = -0.102$ | Signifikant, aber kleiner Effekt | Trotz p < 0.05 ist der Unterschied zwischen Zürich und St. Gallen in der Praxis kaum spürbar. | [N09.ipynb](notebooks/N09.ipynb) |
| **Bootstrap-Validierung** | 10'000 Iterationen (Resampling) | 13.11.2025 | CI für Median: [0.53, 0.85] | Absicherung der Punktschätzer | Das Bootstrap-Konfidenzintervall bestätigt die Robustheit des Medians gegenüber Ausreißern. | [N09.ipynb](notebooks/N09.ipynb) |
| **Varianzstabilisierung** | Clipping & Log-Transformation | 20.11.2025 | Zielvariable `log1p(delay_min)` | Verbesserung der Modellvoraussetzungen | Negative Verspätungen (Frühankünfte) wurden auf 0 gesetzt, um die Log-Transformation zu ermöglichen. | [N10.ipynb](notebooks/N10.ipynb) |
| **Nicht-lineare Effekte** | Polynomiale Terme ($hour^2$) | 20.11.2025 | Verbesserung des Modell-Fits | Berücksichtigung des Tagesverlaufs | Verspätungen steigen über den Tag nicht linear an; das quadratische Modell bildet die Peaks besser ab. | [N10.ipynb](notebooks/N10.ipynb) |
| **Modellvergleich** | AIC / BIC Kriterien | 27.11.2025 | Interaktionsmodell hat niedrigere Werte | Wahl des Interaktionsmodells | Das Modell mit Interaktion (Stunde × Wochentag) beschreibt die Datenstruktur am besten. | [N11.ipynb](notebooks/N11.ipynb) |
| **Multikollinearität** | Variance Inflation Factor (VIF) | 27.11.2025 | Condition Number: $1.46 \times 10^3$ | Überwachung der Prädiktoren-Abhängigkeit | Hohe Werte sind durch die Interaktionsterme und polynomialen Terme mathematisch bedingt. | [N11.ipynb](notebooks/N11.ipynb) |
| **Puffer-Effekt Analyse** | Spearman-Korrelation ($\rho$) | 04.12.2025 | $\rho = 0.13$; $p < 0.05$ | Kein relevanter Puffer-Effekt | Größere Bahnhöfe bauen im Schnitt keine Verspätung ab; die Hypothese der "Selbstheilungskraft" wird verworfen. | [bahnhof-mining-hypothese.ipynb](notebooks/bahnhof-mining-hypothese.ipynb) |
| **Stabilitätsprüfung (Zeitreihe)** | Monatliche Aggregation | 04.12.2025 | Konstante Verspätungsmuster über die Monate | Daten sind für zusammenhängende Auswertung geeignet | Validierung, dass keine zeitlichen Brüche (z.B. durch Fahrplanwechsel) die Statistik verzerren. | [bahnhof-mining.ipynb](notebooks/bahnhof-mining.ipynb) |
| **Betreiber-Korrelation** | Pearson-Koeffizient (Top 5 Betreiber) | 04.12.2025 | $r$ zwischen 0.76 (SBB) und 0.86 (AVA) | Abfahrtsverspätung ist universeller Prädiktor | Unabhängig vom Betreiber ist die Fortpflanzung der Verspätung die dominierende Dynamik. | [bahnhof-mining.ipynb](notebooks/bahnhof-mining.ipynb) |
| **Multiple Testkorrektur** | Benjamini-Hochberg (FDR) | 04.12.2025 | Signifikante Unterschiede SBB vs. Regionalbahnen | Alpha-Fehler-Kontrolle bei Paarvergleichen | Sicherstellung der statistischen Korrektheit beim Vergleich vieler verschiedener Betreiber. | [bahnhof-mining.ipynb](notebooks/bahnhof-mining.ipynb) |